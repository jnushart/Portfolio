{"paragraphs":[{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1588122948882_752937896","id":"20200429-011548_602042908","dateCreated":"2020-04-29T01:15:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:272","text":"val oshkosh = spark.read.format(\"csv\").option(\"header\", true).option(\"inferSchema\", true).load(\"/user/maria_dev/final/Oshkosh/OshkoshWeather.csv\")\nval oshkosh2 = oshkosh.withColumn(\"merge\", concat_ws(\"-\", $\"Year\", $\"Month\", $\"Day\"))\n  .withColumn(\"date\", to_date(unix_timestamp($\"merge\", \"yyyy-MM-dd\").cast(\"timestamp\")))\n  .drop(\"merge\")\n  .withColumn(\"timestamp\", unix_timestamp($\"date\"))\n  .withColumn(\"timeOfDay\", ($\"timestamp\" % 86400))\n  .withColumn(\"daystamp\", ($\"timestamp\" - $\"timeOfDay\"))\nimport org.apache.spark.sql.expressions._\nval windowSpec = Window.orderBy(\"timestamp\").rangeBetween(-259200,259200)\nval answer = oshkosh2.withColumn(\"averageTemp\", avg(\"TemperatureF\").over(windowSpec))\nanswer.createOrReplaceTempView(\"answerTable\")\nspark.sqlContext.sql(\"SELECT DISTINCT date, daystamp, averageTemp FROM answerTable ORDER BY averageTemp DESC\").show","dateUpdated":"2020-04-29T01:16:22+0000","dateFinished":"2020-04-29T01:16:26+0000","dateStarted":"2020-04-29T01:16:22+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"oshkosh: org.apache.spark.sql.DataFrame = [Year: int, Month: int ... 14 more fields]\noshkosh2: org.apache.spark.sql.DataFrame = [Year: int, Month: int ... 18 more fields]\nimport org.apache.spark.sql.expressions._\nwindowSpec: org.apache.spark.sql.expressions.WindowSpec = org.apache.spark.sql.expressions.WindowSpec@30c1dbf0\nanswer: org.apache.spark.sql.DataFrame = [Year: int, Month: int ... 19 more fields]\n+----------+----------+-----------------+\n|      date|  daystamp|      averageTemp|\n+----------+----------+-----------------+\n|2012-07-03|1341273600|81.76132596685085|\n|2012-07-04|1341360000| 80.8888888888889|\n|2012-07-02|1341187200|80.82817679558013|\n|2012-07-05|1341446400|80.60641711229948|\n|2012-07-06|1341532800|80.22222222222224|\n|2012-07-01|1341100800|80.01564245810054|\n|2001-08-06| 997056000|79.96521739130434|\n|2006-07-31|1154304000|79.91249999999998|\n|2006-07-30|1154217600|79.90729166666665|\n|2013-07-16|1373932800|79.61714285714288|\n|2006-07-29|1154131200| 79.5386597938144|\n|2013-07-17|1374019200|79.52400000000002|\n|2006-08-01|1154390400| 79.3333333333333|\n|2011-07-19|1311033600|79.25422885572138|\n|2001-08-07| 997142400|79.16022727272728|\n|2001-08-05| 996969600|79.15585106382976|\n|2011-07-20|1311120000|79.10807174887893|\n|2012-06-30|1341014400|78.96685393258427|\n|2011-07-18|1310947200|78.88407960199004|\n|2012-07-07|1341619200|78.80842696629215|\n+----------+----------+-----------------+\nonly showing top 20 rows\n\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1588122982162_833396389","id":"20200429-011622_70125103","dateCreated":"2020-04-29T01:16:22+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:335"}],"name":"prob1c","id":"2F9EGQM8E","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}