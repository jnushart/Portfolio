{"paragraphs":[{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1588285566194_-356576545","id":"20200430-222606_670843619","dateCreated":"2020-04-30T22:26:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:421","text":"val iowa = spark.read.format(\"csv\").option(\"header\", true).option(\"inferSchema\", true).load(\"/user/maria_dev/final/IowaCity/IowaCityWeather.csv\")\nval iowa2 = iowa.withColumn(\"merge\", concat_ws(\"-\", $\"Year\", $\"Month\", $\"Day\"))\n.withColumn(\"merge2\", concat_ws(\"-\", $\"Year\", $\"Month\", $\"Day\", $\"TimeCST\"))\n  .withColumn(\"date\", to_date(unix_timestamp($\"merge2\", \"yyyy-MM-dd\").cast(\"timestamp\")))\n  .withColumn(\"datetime\", to_timestamp(unix_timestamp($\"merge2\", \"yyyy-MM-dd-hh:mm aa\").cast(\"timestamp\")))\n  .drop(\"merge\")\n  .drop(\"merge2\")\n  .withColumn(\"timestamp\", unix_timestamp($\"datetime\"))\n  .withColumn(\"timeOfHour\", ($\"timestamp\" % 3600))\n  .withColumn(\"hourstamp\", ($\"timestamp\" - $\"timeOfHour\"))\n  .withColumn(\"hourofday\", (($\"hourstamp\" % 86400)/3600))\n  .withColumn(\"windfixed\", when(col(\"Wind SpeedMPH\") === \"Calm\", 0)\n  .when(col(\"Wind SpeedMPH\") < 0, \"N/A\")\n  .otherwise(col(\"Wind SpeedMPH\")))\nval iowa3 = iowa2.filter($\"TemperatureF\" > -9990)\nval tempAvg = iowa3.groupBy($\"month\", $\"hourofday\").agg(avg($\"TemperatureF\").as(\"avgTemp\"), avg(\"windfixed\").as(\"avgWind\"))\nval tempDiff = tempAvg.withColumn(\"DifferenceFrom50\", abs($\"avgTemp\"-50))\nval tempMinDiff = tempDiff.groupBy($\"month\".as(\"month1\")).agg(min($\"DifferenceFrom50\").as(\"min_value\"))\n\nval tempTopByJoin = tempDiff.join(broadcast(tempMinDiff),\n    ($\"month1\" === $\"month\") && ($\"DifferenceFrom50\" === $\"min_value\"))\n  .drop(\"min_hour\")\n  .drop(\"min_value\")\ntempTopByJoin.createOrReplaceTempView(\"answerTable\")\nspark.sqlContext.sql(\"SELECT month, hourofday, avgTemp, avgWind, DifferenceFrom50 FROM answerTable Order by month ASC\").show\n","dateUpdated":"2020-05-01T01:39:59+0000","dateFinished":"2020-05-01T01:40:07+0000","dateStarted":"2020-05-01T01:39:59+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"iowa: org.apache.spark.sql.DataFrame = [Year: int, Month: int ... 14 more fields]\niowa2: org.apache.spark.sql.DataFrame = [Year: int, Month: int ... 21 more fields]\niowa3: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [Year: int, Month: int ... 21 more fields]\ntempAvg: org.apache.spark.sql.DataFrame = [month: int, hourofday: double ... 2 more fields]\ntempDiff: org.apache.spark.sql.DataFrame = [month: int, hourofday: double ... 3 more fields]\ntempMinDiff: org.apache.spark.sql.DataFrame = [month1: int, min_value: double]\ntempTopByJoin: org.apache.spark.sql.DataFrame = [month: int, hourofday: double ... 4 more fields]\n+-----+---------+------------------+------------------+-------------------+\n|month|hourofday|           avgTemp|           avgWind|   DifferenceFrom50|\n+-----+---------+------------------+------------------+-------------------+\n|    1|     14.0|27.611127167630055|11.345520231213875| 22.388872832369945|\n|    2|     14.0|29.795017182130596|11.620695652173914| 20.204982817869404|\n|    3|     14.0| 45.63989726027398|11.970912220309808|  4.360102739726017|\n|    4|     22.0| 49.85449735449738| 7.960424028268558|0.14550264550261716|\n|    5|      5.0| 53.59693251533743| 5.478783151326051| 3.5969325153374285|\n|    6|      5.0|63.236808846761434| 4.892788461538458| 13.236808846761434|\n|    7|      5.0| 66.97230046948357| 3.967138364779872|  16.97230046948357|\n|    8|      5.0| 65.23699059561129|3.4710031347962373| 15.236990595611289|\n|    9|      5.0| 55.92711598746082|3.4089341692789947|  5.927115987460823|\n|   10|     22.0| 49.61691449814126| 5.926728971962615|0.38308550185873713|\n|   11|     13.0| 46.87456445993031|11.755671902268752|  3.125435540069688|\n|   12|     14.0|31.436376811594233|10.736918604651166| 18.563623188405767|\n+-----+---------+------------------+------------------+-------------------+\n\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1588287942081_534687966","id":"20200430-230542_2033597111","dateCreated":"2020-04-30T23:05:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:695","text":"val oshkosh = spark.read.format(\"csv\").option(\"header\", true).option(\"inferSchema\", true).load(\"/user/maria_dev/final/Oshkosh/OshkoshWeather.csv\")\nval oshkosh2 = oshkosh.withColumn(\"merge\", concat_ws(\"-\", $\"Year\", $\"Month\", $\"Day\"))\n.withColumn(\"merge2\", concat_ws(\"-\", $\"Year\", $\"Month\", $\"Day\", $\"TimeCST\"))\n  .withColumn(\"date\", to_date(unix_timestamp($\"merge2\", \"yyyy-MM-dd\").cast(\"timestamp\")))\n  .withColumn(\"datetime\", to_timestamp(unix_timestamp($\"merge2\", \"yyyy-MM-dd-hh:mm aa\").cast(\"timestamp\")))\n  .drop(\"merge\")\n  .drop(\"merge2\")\n  .withColumn(\"timestamp\", unix_timestamp($\"datetime\"))\n  .withColumn(\"timeOfHour\", ($\"timestamp\" % 3600))\n  .withColumn(\"hourstamp\", ($\"timestamp\" - $\"timeOfHour\"))\n  .withColumn(\"hourofday\", (($\"hourstamp\" % 86400)/3600))\n  .withColumn(\"windfixed\", when(col(\"Wind SpeedMPH\") === \"Calm\", 0)\n  .when(col(\"Wind SpeedMPH\") < 0, \"N/A\")\n  .otherwise(col(\"Wind SpeedMPH\")))\nval oshkosh3 = oshkosh2.filter($\"TemperatureF\" > -9990)\nval tempAvg = oshkosh3.groupBy($\"month\", $\"hourofday\").agg(avg($\"TemperatureF\").as(\"avgTemp\"), avg(\"windfixed\").as(\"avgWind\"))\nval tempDiff = tempAvg.withColumn(\"DifferenceFrom50\", abs($\"avgTemp\"-50))\nval tempMinDiff = tempDiff.groupBy($\"month\".as(\"month1\")).agg(min($\"DifferenceFrom50\").as(\"min_value\"))\n\nval tempTopByJoin = tempDiff.join(broadcast(tempMinDiff),\n    ($\"month1\" === $\"month\") && ($\"DifferenceFrom50\" === $\"min_value\"))\n  .drop(\"min_hour\")\n  .drop(\"min_value\")\ntempTopByJoin.createOrReplaceTempView(\"answerTable\")\nspark.sqlContext.sql(\"SELECT month, hourofday, avgTemp, avgWind, DifferenceFrom50 FROM answerTable order by month ASC\").show","dateUpdated":"2020-05-01T01:41:13+0000","dateFinished":"2020-05-01T01:41:21+0000","dateStarted":"2020-05-01T01:41:13+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"oshkosh: org.apache.spark.sql.DataFrame = [Year: int, Month: int ... 14 more fields]\noshkosh2: org.apache.spark.sql.DataFrame = [Year: int, Month: int ... 21 more fields]\noshkosh3: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [Year: int, Month: int ... 21 more fields]\ntempAvg: org.apache.spark.sql.DataFrame = [month: int, hourofday: double ... 2 more fields]\ntempDiff: org.apache.spark.sql.DataFrame = [month: int, hourofday: double ... 3 more fields]\ntempMinDiff: org.apache.spark.sql.DataFrame = [month1: int, min_value: double]\ntempTopByJoin: org.apache.spark.sql.DataFrame = [month: int, hourofday: double ... 4 more fields]\n+-----+---------+------------------+------------------+-------------------+\n|month|hourofday|           avgTemp|           avgWind|   DifferenceFrom50|\n+-----+---------+------------------+------------------+-------------------+\n|    1|     14.0| 24.20747384155457|10.285949177877432|  25.79252615844543|\n|    2|     14.0|26.520998278829598|11.142340791738375| 23.479001721170402|\n|    3|     14.0| 38.89300155520995| 11.07710280373831| 11.106998444790051|\n|    4|     17.0| 50.34099485420238|11.730188679245275| 0.3409948542023784|\n|    5|      5.0| 50.18430141287281| 7.726299212598426|0.18430141287281288|\n|    6|      5.0|  59.7744610281924| 5.815358931552584|  9.774461028192398|\n|    7|      5.0| 64.10480769230769| 5.342307692307687| 14.104807692307688|\n|    8|      5.0| 62.62076069730587| 5.194703049759227| 12.620760697305869|\n|    9|      4.0|55.986079999999994|  5.72038834951456|  5.986079999999994|\n|   10|     19.0| 49.84615384615383| 7.404273504273507| 0.1538461538461675|\n|   11|     13.0| 42.21481481481485|10.851465798045599|  7.785185185185149|\n|   12|     13.0| 29.13762662807525|10.685817655571633|  20.86237337192475|\n+-----+---------+------------------+------------------+-------------------+\n\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1588295740127_-364175315","id":"20200501-011540_2045582661","dateCreated":"2020-05-01T01:15:40+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1094"}],"name":"Untitled Note 5","id":"2F89GGUD5","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}