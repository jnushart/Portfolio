{"paragraphs":[{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1588285566194_-356576545","id":"20200430-222606_670843619","dateCreated":"2020-04-30T22:26:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:421","text":"val iowa = spark.read.format(\"csv\").option(\"header\", true).option(\"inferSchema\", true).load(\"/user/maria_dev/final/IowaCity/IowaCityWeather.csv\")\nval iowa2 = iowa.withColumn(\"merge\", concat_ws(\"-\", $\"Year\", $\"Month\", $\"Day\"))\n.withColumn(\"merge2\", concat_ws(\"-\", $\"Year\", $\"Month\", $\"Day\", $\"TimeCST\"))\n  .withColumn(\"date\", to_date(unix_timestamp($\"merge2\", \"yyyy-MM-dd\").cast(\"timestamp\")))\n  .withColumn(\"datetime\", to_timestamp(unix_timestamp($\"merge2\", \"yyyy-MM-dd-hh:mm aa\").cast(\"timestamp\")))\n  .drop(\"merge\")\n  .drop(\"merge2\")\n  .withColumn(\"timestamp\", unix_timestamp($\"datetime\"))\nval iowa3 = iowa2.filter($\"TemperatureF\" > -9990)\nimport org.apache.spark.sql.expressions._\nval windowSpec = Window.orderBy(\"timestamp\").rangeBetween(-43200,43200)\nval answer = iowa3.withColumn(\"tempMax\", max(\"TemperatureF\").over(windowSpec))\nval answer2 = answer.withColumn(\"tempMin\", min(\"TemperatureF\").over(windowSpec))\nanswer2.createOrReplaceTempView(\"answerTable\")\nspark.sqlContext.sql(\"SELECT DISTINCT date, TimeCST, tempMax, tempMin, (tempMax-tempMin) AS tempDiff FROM answerTable ORDER BY tempDiff DESC\").show","dateUpdated":"2020-04-30T23:08:44+0000","dateFinished":"2020-04-30T23:08:50+0000","dateStarted":"2020-04-30T23:08:44+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"iowa: org.apache.spark.sql.DataFrame = [Year: int, Month: int ... 14 more fields]\niowa2: org.apache.spark.sql.DataFrame = [Year: int, Month: int ... 17 more fields]\niowa3: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [Year: int, Month: int ... 17 more fields]\nimport org.apache.spark.sql.expressions._\nwindowSpec: org.apache.spark.sql.expressions.WindowSpec = org.apache.spark.sql.expressions.WindowSpec@64b3fc0d\nanswer: org.apache.spark.sql.DataFrame = [Year: int, Month: int ... 18 more fields]\nanswer2: org.apache.spark.sql.DataFrame = [Year: int, Month: int ... 19 more fields]\n+----------+--------+-------+-------+--------+\n|      date| TimeCST|tempMax|tempMin|tempDiff|\n+----------+--------+-------+-------+--------+\n|2008-12-14| 6:52 PM|   57.2|    1.0|    56.2|\n|2008-12-14| 7:39 PM|   57.2|    1.0|    56.2|\n|2008-12-14| 9:52 PM|   57.2|    1.0|    56.2|\n|2008-12-14| 8:05 PM|   57.2|    1.0|    56.2|\n|2008-12-14| 8:52 PM|   57.2|    1.0|    56.2|\n|2008-12-14|10:04 PM|   57.2|    1.0|    56.2|\n|2008-12-14|10:08 PM|   57.2|    1.0|    56.2|\n|2008-12-14| 9:30 PM|   57.2|    1.0|    56.2|\n|2008-12-14|10:23 PM|   57.2|    1.0|    56.2|\n|2008-12-14|10:34 PM|   57.2|    1.0|    56.2|\n|2008-12-14|10:52 PM|   57.2|    1.0|    56.2|\n|2008-12-14|11:03 PM|   57.2|    1.0|    56.2|\n|2008-12-14|11:28 PM|   57.2|    1.0|    56.2|\n|2008-12-14|11:44 PM|   57.2|    1.0|    56.2|\n|2008-12-14|11:52 PM|   57.2|    1.0|    56.2|\n|2008-12-14|11:59 PM|   57.2|    1.0|    56.2|\n|2008-12-15|12:16 AM|   57.2|    1.0|    56.2|\n|2008-12-14|10:16 PM|   57.2|    1.0|    56.2|\n|2008-12-14| 7:52 PM|   57.2|    1.0|    56.2|\n|2008-12-15|12:52 AM|   57.0|    1.0|    56.0|\n+----------+--------+-------+-------+--------+\nonly showing top 20 rows\n\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1588286963774_884634321","id":"20200430-224923_1819168053","dateCreated":"2020-04-30T22:49:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:573","text":"val oshkosh = spark.read.format(\"csv\").option(\"header\", true).option(\"inferSchema\", true).load(\"/user/maria_dev/final/Oshkosh/OshkoshWeather.csv\")\nval oshkosh2 = oshkosh.withColumn(\"merge\", concat_ws(\"-\", $\"Year\", $\"Month\", $\"Day\"))\n.withColumn(\"merge2\", concat_ws(\"-\", $\"Year\", $\"Month\", $\"Day\", $\"TimeCST\"))\n  .withColumn(\"date\", to_date(unix_timestamp($\"merge2\", \"yyyy-MM-dd\").cast(\"timestamp\")))\n  .withColumn(\"datetime\", to_timestamp(unix_timestamp($\"merge2\", \"yyyy-MM-dd-hh:mm aa\").cast(\"timestamp\")))\n  .drop(\"merge\")\n  .drop(\"merge2\")\n  .withColumn(\"timestamp\", unix_timestamp($\"datetime\"))\nval oshkosh3 = oshkosh2.filter($\"TemperatureF\" > -9990)\nimport org.apache.spark.sql.expressions._\nval windowSpec = Window.orderBy(\"timestamp\").rangeBetween(-43200,43200)\nval answer = oshkosh3.withColumn(\"tempMax\", max(\"TemperatureF\").over(windowSpec))\nval answer2 = answer.withColumn(\"tempMin\", min(\"TemperatureF\").over(windowSpec))\nanswer2.createOrReplaceTempView(\"answerTable\")\nspark.sqlContext.sql(\"SELECT DISTINCT date, TimeCST, tempMax, tempMin, (tempMax-tempMin) AS tempDiff FROM answerTable ORDER BY tempDiff DESC\").show","dateUpdated":"2020-04-30T23:13:23+0000","dateFinished":"2020-04-30T23:13:28+0000","dateStarted":"2020-04-30T23:13:23+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"oshkosh: org.apache.spark.sql.DataFrame = [Year: int, Month: int ... 14 more fields]\noshkosh2: org.apache.spark.sql.DataFrame = [Year: int, Month: int ... 17 more fields]\noshkosh3: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [Year: int, Month: int ... 17 more fields]\nimport org.apache.spark.sql.expressions._\nwindowSpec: org.apache.spark.sql.expressions.WindowSpec = org.apache.spark.sql.expressions.WindowSpec@46c6b06\nanswer: org.apache.spark.sql.DataFrame = [Year: int, Month: int ... 18 more fields]\nanswer2: org.apache.spark.sql.DataFrame = [Year: int, Month: int ... 19 more fields]\n+----------+-------+-------+-------+--------+\n|      date|TimeCST|tempMax|tempMin|tempDiff|\n+----------+-------+-------+-------+--------+\n|2008-01-29|5:53 PM|   39.2|  -11.9|    51.1|\n|2008-01-29|7:08 PM|   39.2|  -11.9|    51.1|\n|2008-01-29|6:12 PM|   39.2|  -11.9|    51.1|\n|2008-01-29|7:53 PM|   39.2|  -11.9|    51.1|\n|2008-01-29|8:10 PM|   39.2|  -11.9|    51.1|\n|2008-01-29|6:02 PM|   39.2|  -11.9|    51.1|\n|2008-01-29|6:20 PM|   39.2|  -11.9|    51.1|\n|2008-01-29|6:53 PM|   39.2|  -11.9|    51.1|\n|2008-01-29|3:53 PM|   39.9|  -11.0|    50.9|\n|2008-01-29|8:53 PM|   39.0|  -11.9|    50.9|\n|2008-01-29|4:53 PM|   39.2|  -11.0|    50.2|\n|2008-01-29|5:01 PM|   39.2|  -11.0|    50.2|\n|2008-01-29|4:36 PM|   39.2|  -11.0|    50.2|\n|2008-01-29|5:15 PM|   39.2|  -11.0|    50.2|\n|2008-01-29|5:41 PM|   39.2|  -11.0|    50.2|\n|2008-01-29|5:28 PM|   39.2|  -11.0|    50.2|\n|2008-01-29|5:48 PM|   39.2|  -11.0|    50.2|\n|2008-01-29|2:53 PM|   39.9|   -9.9|    49.8|\n|2008-01-29|3:03 PM|   39.9|   -9.9|    49.8|\n|2008-01-29|3:12 PM|   39.9|   -9.9|    49.8|\n+----------+-------+-------+-------+--------+\nonly showing top 20 rows\n\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1588287942081_534687966","id":"20200430-230542_2033597111","dateCreated":"2020-04-30T23:05:42+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:695"}],"name":"Untitled Note 5","id":"2F89GGUD5","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}